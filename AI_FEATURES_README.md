# AI Features for ResourcePro

This document explains how to set up and use the AI-powered features in ResourcePro.

## Features Implemented

### 1. Smart Skill Recommendation Engine
- **Location**: `/analytics/ai/skill-recommendations/`
- **Purpose**: Analyzes current team skills and project requirements to suggest:
  - Skills to develop
  - Training areas to focus on
  - Skills that might become obsolete
- **AI Model**: Uses Gemini 1.5 Flash to analyze team composition and project demands

### 2. Resource Allocation Advisor
- **Location**: `/analytics/ai/resource-allocation/<task_id>/`
- **Purpose**: Suggests optimal resource assignments for specific tasks based on:
  - Skill matching
  - Resource availability
  - Cost efficiency
  - Experience alignment
- **AI Model**: Uses Gemini 1.5 Flash to evaluate resource-task fit

### 3. Intelligent Resource Demand Forecasting
- **Location**: `/analytics/ai/enhanced-forecasts/`
- **Purpose**: Enhances statistical forecasts with AI insights considering:
  - Business context
  - Market trends
  - Seasonal patterns
  - Strategic initiatives
- **AI Model**: Uses Gemini 1.5 Flash to adjust ML-generated forecasts

## Setup Instructions

### 1. Install Dependencies
```bash
pip install google-generativeai>=0.3.0
```

### 2. Configure Gemini API Key
Set your Gemini API key as an environment variable:

**Windows:**
```cmd
set GEMINI_API_KEY=your_api_key_here
```

**Linux/Mac:**
```bash
export GEMINI_API_KEY=your_api_key_here
```

**Or add to your `.env` file:**
```
GEMINI_API_KEY=your_api_key_here
```

### 3. Apply Database Migrations
```bash
python manage.py migrate
```

### 4. Test AI Features
```bash
# Test all AI features
python manage.py test_ai_features

# Test specific features
python manage.py test_ai_features --feature skills
python manage.py test_ai_features --feature allocation --task-id 1
python manage.py test_ai_features --feature forecasting
```

## Usage

### 1. Web Interface
Visit `/analytics/ai/` to access the AI Analytics Dashboard where you can:
- Generate skill recommendations
- Analyze resource allocation for tasks
- Create AI-enhanced forecasts
- View strategic recommendations

### 2. API Endpoints

#### Skill Recommendations
```http
GET /analytics/ai/skill-recommendations/
GET /analytics/ai/skill-recommendations/?refresh=true
```

#### Resource Allocation
```http
GET /analytics/ai/resource-allocation/1/
GET /analytics/ai/resource-allocation/1/?refresh=true
```

#### Enhanced Forecasting
```http
GET /analytics/ai/enhanced-forecasts/?days_ahead=30
POST /analytics/ai/enhanced-forecasts/
{
    "business_context": "Launching new product line in Q2"
}
```

#### Strategic Recommendations
```http
POST /analytics/ai/strategic-recommendations/
{
    "enhanced_forecasts": { ... }
}
```

## Data Requirements

### For Skill Recommendations:
- Resources with assigned skills
- Projects with tasks requiring specific skills
- Historical skill demand data (optional)

### For Resource Allocation:
- Resources with skills and utilization data
- Tasks with skill requirements
- Historical assignment patterns

### For Enhanced Forecasting:
- Historical time entries and assignments
- Statistical forecasts (generated by ML models)
- Business context information

## AI Service Architecture

### Core Components:
1. **`utils/gemini_ai.py`**: Core AI service wrapper
2. **`analytics/ai_services.py`**: AI-powered analytics services
3. **`analytics/models.py`**: Database models for AI recommendations
4. **`analytics/views.py`**: API endpoints for AI features

### Key Classes:
- `GeminiAIService`: Main AI service interface
- `AISkillRecommendationService`: Skill analysis and recommendations
- `AIResourceAllocationService`: Resource allocation optimization
- `AIForecastEnhancementService`: Forecast enhancement and strategic planning

## Troubleshooting

### Common Issues:

1. **"Gemini AI not available"**
   - Check that `GEMINI_API_KEY` is set correctly
   - Verify the API key is valid and has quota
   - Ensure `google-generativeai` package is installed

2. **"No recommendations generated"**
   - Ensure you have sufficient data (resources, skills, projects)
   - Check that projects have tasks with skill requirements
   - Verify resources have assigned skills

3. **"Insufficient data for forecasting"**
   - Need at least 10 historical data points
   - Ensure time entries and assignments exist
   - Check that resources have been assigned to tasks

### Debugging:
```bash
# Check AI service status
python manage.py shell
>>> from utils.gemini_ai import gemini_service
>>> print(gemini_service.is_available())

# Test individual components
>>> from analytics.ai_services import AISkillRecommendationService
>>> service = AISkillRecommendationService()
>>> result = service.generate_skill_recommendations(force_refresh=True)
>>> print(result)
```

## Cost Considerations

- Gemini 1.5 Flash API costs are based on tokens processed
- Recommendations are cached for 24 hours (skills) or 4 hours (allocation)
- Use `force_refresh=false` in production to avoid unnecessary API calls
- Consider implementing rate limiting for high-traffic applications

## Future Enhancements

1. **Natural Language Time Entry**: Allow users to enter time in natural language
2. **Project Risk Analysis**: AI-powered project risk assessment
3. **Automated Reporting**: AI-generated insights and reports
4. **Predictive Analytics**: More sophisticated forecasting models
5. **Skill Gap Analysis**: Deeper analysis of skill gaps and training needs

## Contributing

When adding new AI features:
1. Follow the existing pattern in `ai_services.py`
2. Add appropriate database models for storing AI results
3. Create API endpoints in `views.py`
4. Add tests in the management command
5. Update this documentation
